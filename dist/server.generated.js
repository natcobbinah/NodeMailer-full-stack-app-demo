(()=>{"use strict";var e={986:e=>{e.exports=require("body-parser")},582:e=>{e.exports=require("cors")},142:e=>{e.exports=require("dotenv")},860:e=>{e.exports=require("express")},616:e=>{e.exports=require("formidable")},184:e=>{e.exports=require("nodemailer")},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")}},r={};function t(s){var o=r[s];if(void 0!==o)return o.exports;var n=r[s]={exports:{}};return e[s](n,n.exports,t),n.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var s in r)t.o(r,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:r[s]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{t.r(s);var e=t(17),r=t.n(e);const o=process.cwd();t(142).config({path:r().join(o,"./server/env/.env")});const n={port:process.env.PORT,EMAIL_PASSWORD:process.env.EMAIL_APP_PASSWORD,USER_EMAIL:process.env.USER_EMAIL},a=t(184).createTransport({service:"gmail",host:"smtp.gmail.com",port:587,secure:!1,auth:{user:n.USER_EMAIL,pass:n.EMAIL_PASSWORD},tls:{rejectUnauthorized:!1}}),i=(t(17),t(147)),{IncomingForm:l}=t(616),p=t(860).Router();p.route("/api/sendEmail").post((async(e,r)=>{new l({keepExtensions:!0,multiples:!0}).parse(e,((e,t,s)=>{if(e)return r.status(400).json({error:"form data not valid"});let o=[],l=[];if(s){for(const[e,r]of Object.entries(s))o.push(JSON.stringify(r));o.forEach((e=>{let r=JSON.parse(e);l.push({filename:JSON.stringify(r.originalFilename),content:i.createReadStream(r.filepath),contentType:JSON.stringify(r.mimetype)})}))}console.log(t);let p=[];for(const[e,r]of Object.entries(t))p.push(r[1]);try{a.verify(((e,r)=>{e?console.log(e):console.log("Server is ready to take our messages")}));let e={from:p[1],to:n.USER_EMAIL,subject:p[2],html:`\n                    Hello, I am ${p[0]}\n                    <p>${p[3]}</p>\n                    <p>Kind Regards</p>\n                    <p>${p[0]}</p>\n                `,attachments:l};a.sendMail(e,((e,t)=>e?r.status(400).json({error:"Error sending email, try again later"}):(console.log("Email send:"+t.response),r.status(200).json({message:"Email sent successfully"}))))}catch(e){return r.status(400).json({error:"Sending email error"})}}))}));const c=p,u=t(860),d=t(986),m=t(582),f=process.cwd(),g=u();g.use(d.json()),g.use(d.urlencoded({extended:!0})),g.use(m()),g.use("/dist",u.static(r().join(f,"/dist"))),g.use("/client/assets",u.static(r().join(f,"/client/assets"))),g.get("/",((e,t)=>{t.status(200).sendFile(r().join(f,"/client/index.html"))})),g.use("/",c),g.listen(n.port,(e=>{e&&console.log(e),console.log("Server started on port %s",n.port),console.log("Nodemailer app is available on  http://localhost:%d",n.port)}))})(),module.exports=s})();